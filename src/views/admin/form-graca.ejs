<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-8 flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-display text-gray-900">
                <%= graca ? 'Editar' : 'Nova' %> Graça
            </h1>
            <a href="/admin/gracas" class="text-sm text-gold hover:text-wine font-medium">&larr; Voltar para lista</a>
        </div>
    </div>

    <% if (locals.error) { %>
        <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6" role="alert">
            <p>
                <%= error %>
            </p>
        </div>
        <% } %>

            <form action="<%= graca ? `/admin/gracas/${graca.id}/editar` : '/admin/gracas/nova' %>" method="POST"
                class="bg-white shadow-sm rounded-lg border border-gray-200 p-6 space-y-6">

                <h3 class="text-lg leading-6 font-medium text-gray-900 border-b pb-2">Vínculos</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Intercessor -->
                    <div>
                        <label for="intercessor_id" class="block text-sm font-medium text-gray-700">Intercessor
                            *</label>
                        <select id="intercessor_id" name="intercessor_id" required
                            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-gold focus:border-gold sm:text-sm">
                            <option value="">Selecione...</option>
                            <% intercessores.forEach(i=> { %>
                                <option value="<%= i.id %>" <%=graca && graca.intercessor_id===i.id ? 'selected' : '' %>
                                    ><%= i.nome %>
                                </option>
                                <% }) %>
                        </select>
                    </div>

                    <!-- Comunidade -->
                    <div>
                        <label for="comunidades_id" class="block text-sm font-medium text-gray-700">Comunidade
                            (Opcional)</label>
                        <select id="comunidades_id" name="comunidades_id"
                            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-gold focus:border-gold sm:text-sm">
                            <option value="">Nenhuma</option>
                            <% comunidades.forEach(c=> { %>
                                <option value="<%= c.id %>" <%=graca && graca.comunidades_id===c.id ? 'selected' : '' %>
                                    ><%= c.nome %>
                                </option>
                                <% }) %>
                        </select>
                    </div>
                </div>

                <h3 class="text-lg leading-6 font-medium text-gray-900 border-b pb-2 pt-4">Dados da Graça</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Nome Exibição -->
                    <div>
                        <label for="nome_exibicao" class="block text-sm font-medium text-gray-700">Nome de Exibição (Ex:
                            J.S.) *</label>
                        <input type="text" name="nome_exibicao" id="nome_exibicao" required
                            value="<%= graca ? graca.nome_exibicao : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border">
                    </div>

                    <!-- Nome Privado -->
                    <div>
                        <label for="nome_privado" class="block text-sm font-medium text-gray-700">Nome Completo
                            (Interno)</label>
                        <input type="text" name="nome_privado" id="nome_privado"
                            value="<%= graca ? graca.nome_privado : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"
                            placeholder="Somente para controle">
                    </div>

                    <!-- Localidade -->
                    <div>
                        <label for="localidade" class="block text-sm font-medium text-gray-700">Localidade (Cidade/UF)
                            *</label>
                        <input type="text" name="localidade" id="localidade" required
                            value="<%= graca ? graca.localidade : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border">
                    </div>

                    <!-- Slug -->
                    <div>
                        <label for="slug" class="block text-sm font-medium text-gray-700">Slug (Código da Graça)
                            *</label>
                        <input type="text" name="slug" id="slug" required value="<%= graca ? graca.slug : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"
                            placeholder="Ex: jsk ou loren">
                        <p class="mt-1 text-xs text-gray-500">Deve ser único para o intercessor selecionado.</p>
                    </div>
                </div>

                <!-- Resumo -->
                <div>
                    <label for="resumo" class="block text-sm font-medium text-gray-700">Resumo *</label>
                    <textarea name="resumo" id="resumo" rows="2" required maxlength="255"
                        class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"><%= graca ? graca.resumo : '' %></textarea>
                    <p class="mt-1 text-xs text-gray-500">Breve descrição para aparecer nos cards.</p>
                </div>

                <!-- Relato -->
                <div>
                    <label for="relato" class="block text-sm font-medium text-gray-700">Relato Completo *</label>
                    <textarea name="relato" id="relato" rows="10" required
                        class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"><%= graca ? graca.relato : '' %></textarea>
                </div>

                <h3 class="text-lg leading-6 font-medium text-gray-900 border-b pb-2 pt-4">Mídia</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Santinho Frente -->
                    <div>
                        <label for="imagem_santinho_frente" class="block text-sm font-medium text-gray-700">URL Santinho
                            (Frente)</label>
                        <input type="text" name="imagem_santinho_frente" id="imagem_santinho_frente"
                            value="<%= graca ? graca.imagem_santinho_frente : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"
                            placeholder="/uploads/...">
                    </div>

                    <!-- Santinho Verso -->
                    <div>
                        <label for="imagem_santinho_verso" class="block text-sm font-medium text-gray-700">URL Santinho
                            (Verso)</label>
                        <input type="text" name="imagem_santinho_verso" id="imagem_santinho_verso"
                            value="<%= graca ? graca.imagem_santinho_verso : '' %>"
                            class="mt-1 focus:ring-gold focus:border-gold block w-full shadow-sm sm:text-sm border-gray-300 rounded-md py-2 px-3 border"
                            placeholder="/uploads/...">
                    </div>
                </div>

                <!-- Status -->
                <div class="pt-4">
                    <label for="status" class="block text-sm font-medium text-gray-700">Status</label>
                    <select id="status" name="status"
                        class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-gold focus:border-gold sm:text-sm">
                        <option value="rascunho" <%=graca && graca.status==='rascunho' ? 'selected' : '' %>>Rascunho
                        </option>
                        <option value="publicado" <%=graca && graca.status==='publicado' ? 'selected' : '' %>>Publicado
                        </option>
                    </select>
                </div>

                <div class="flex justify-end pt-5">
                    <a href="/admin/gracas"
                        class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gold mr-3">
                        Cancelar
                    </a>
                    <button type="submit"
                        class="bg-wine border border-transparent rounded-md shadow-sm py-2 px-4 inline-flex justify-center text-sm font-medium text-white hover:bg-wine/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-wine">
                        Salvar
                    </button>
                </div>
            </form>
</div>